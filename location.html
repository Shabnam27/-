<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Прогноз погоды</title>
</head>
<body>
<div id="weather" class="weather-container">
  <div id="weather-info" class="weather-info"></div>
</div>

<style>
  .weather-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100vh;
}

.weather-info {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
}

.weather-info span {
  margin: 5px;
}

</style>

<script>
  document.addEventListener("DOMContentLoaded", function() {
  const weatherInfo = document.getElementById('weather-info');
  const meterButton = document.createElement('button');
  meterButton.innerText = 'Fahrenheit';
  meterButton.id = 'meter';
  let fahrenheit = false;

  const setWeather = (data) => {
    const name = data.name;
    const temp = fahrenheit ? (data.main.temp * 1.8 + 32).toFixed(1) + 'F' : data.main.temp.toFixed(1) + '°';
    const weatherCondition = data.weather ? data.weather[0].main : '';
    const tempMax = fahrenheit ? Math.round(data.main.temp_max * 1.8 + 32) + 'F' : Math.round(data.main.temp_max) + '°';
    const tempMin = fahrenheit ? Math.round(data.main.temp_min * 1.8 + 32) + 'F' : Math.round(data.main.temp_min) + '°';

    weatherInfo.innerHTML = `
      <div>
        <span>${name}</span>
        <span>${temp}</span>
      </div>
      <div>
        ${weatherCondition && `<img src="https://cdn.pixabay.com/photo/2016/03/18/15/06/fog-1265203_1280.png" alt="Weather" width="50"/>`}
        <span>${weatherCondition}</span>
      </div>
    `;
  };

  const fetchWeather = (lat, lon) => {
    const api = `https://weather-proxy.freecodecamp.rocks/api/current?lat=${lat}&lon=${lon}`;
    fetch(api)
      .then(response => response.json())
      .then(data => setWeather(data))
      .catch(error => console.error('Ошибка:', error));
  };

  const handleMeter = () => {
    fahrenheit = !fahrenheit;
    meterButton.innerText = fahrenheit ? 'Celsius' : 'Fahrenheit';
  };

  meterButton.addEventListener('click', handleMeter);

  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(position => {
      const lat = position.coords.latitude;
      const lon = position.coords.longitude;
      fetchWeather(lat, lon);
    }, error => {
      console.error('Ошибка геолокации:', error);
      weatherInfo.innerText = 'Ошибка получения геолокации';
    });
  } else {
    weatherInfo.innerText = 'Геолокация не поддерживается вашим браузером';
  }

  weatherInfo.appendChild(meterButton);
});

</script>

</body>
</html>
